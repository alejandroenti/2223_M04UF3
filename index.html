<!DOCTYPE html>
<html>
	<head>
		<title>ENTI Survivors</title>
		<!--script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.55.2/phaser.min.js" integrity="sha512-kg6fSrg6FkD9Ua02PzuA289KatVkTp6HdiFrSKwnz1bKBeKe5JG54rNeYZeghYO/I4ka49rb9H/9Ezcq9Se3iQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.55.2/phaser-arcade-physics.min.js" integrity="sha512-3ggJ43PNjH5aQCsd8/CBKa18RPMR8OaQX0JvHCZ4iJO/2Jk9mLdVZYVGFVUJmIoKeoF9Hg1pVgmROv9+xpgQlQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	</head>
	<body>
		<h1>ENTI Survivors</h1>
		<script>

			const config = {
				width: 960,
				height: 540,
				physics: {
			        default: 'arcade',
			        arcade: {
			            debug: true
			        }
			    },
				scene: {
					preload: precarga,
					create: crear,
					update: actualiza
				}
			};

			const game = new Phaser.Game(config);
			
			let player;
			let enemies = [];
			let enemy_padding = 128;
			let enemies_pos = [
				{x: enemy_padding, y: enemy_padding},
				{x: config.width / 2, y: enemy_padding},
				{x: config.width - enemy_padding, y: enemy_padding},
				{x: enemy_padding, y: config.height / 2},
				{x: config.width - enemy_padding, y: config.height / 2},
				{x: enemy_padding, y: config.height - enemy_padding},
				{x: config.width / 2, y: config.height - enemy_padding},
				{x: config.width - enemy_padding, y: config.height - enemy_padding}
			]

			let player_speed = 3;

			let keyLeft;
			let keyRight;
			let keyUp;
			let keyDown;

			function precarga () {

				this.load.image("player-img", "player.png");
				this.load.image("enemy-1", "enemy1.png");
				this.load.image("enemy-2", "enemy2.png");
				this.load.image("enemy-3", "enemy3.png");
				this.load.image("enemy-4", "enemy4.png");
				this.load.image("enemy-5", "enemy5.png");
				this.load.image("enemy-6", "enemy6.png");
				this.load.image("enemy-7", "enemy7.png");
				this.load.image("enemy-8", "enemy8.png");
				
			}

			function crear () {

				player = this.add.image(config.width / 2, config.height / 2, "player-img");
				
				this.physics.add.existing(player, false);
				player.body.setCollideWorldBounds(true);

				for (let i = 0; i < enemies_pos.length; i++) {
					let enemy = this.add.sprite(enemies_pos[i].x, enemies_pos[i].y , "enemy-" + (i + 1));
					this.physics.add.existing(enemy, false);
					enemy.body.setCollideWorldBounds(true);
					enemies.push(enemy);
				}
				
				this.physics.add.collider(player, enemies);

				key_left = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT);
				key_right= this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT);
				key_up = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.UP);
				key_down = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.DOWN);
			}
			
			function actualiza () {


				if (key_left.isDown) {
					player.x -= player_speed;
				}
				else if (key_right.isDown) {
					player.x += player_speed;
				}
				
				if (key_up.isDown) {
					player.y -= player_speed;
				}
				else if (key_down.isDown) {
					player.y += player_speed;
				}

				for (let i= 0; i < enemies.length; i++) {
					this.physics.moveToObject(enemies[i], player);
					this.physics.collide(enemies[i], enemies);
				}

				  
				this.physics.collide(player, enemies);

		}

		</script>
	</body>
</html>
